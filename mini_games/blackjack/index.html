<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Google Analytics (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KFCTS5DZ6V"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-KFCTS5DZ6V');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- SEO Meta Tags -->
    <title>ë¸”ë™ì­ ë§ˆìŠ¤í„° - AI ì „ëµ ì‹œë®¬ë ˆì´í„° & íŠ¸ë ˆì´ë‹</title>
    <meta name="description" content="AI ì „ëµ ì–´ì‹œìŠ¤í„´íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ê³ ê¸‰ ë¸”ë™ì­ ì‹œë®¬ë ˆì´í„°ì…ë‹ˆë‹¤. ì‹¤ì‹œê°„ í™•ë¥  ë¶„ì„ê³¼ ìƒì„¸í•œ ì „ëµ ì„¤ëª…ì„ í†µí•´ ë¸”ë™ì­ ì‹¤ë ¥ì„ í–¥ìƒì‹œí‚¤ì„¸ìš”.">
    <meta name="keywords" content="ë¸”ë™ì­, ë¸”ë™ì­ ì‹œë®¬ë ˆì´í„°, ë¸”ë™ì­ ì „ëµ, ì¹´ì§€ë…¸ ê²Œì„, AI ì „ëµ, ë¸”ë™ì­ ì—°ìŠµ, í™•ë¥  ë¶„ì„">
    <meta name="author" content="Blackjack Master Team">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com/">
    <meta property="og:title" content="ë¸”ë™ì­ ë§ˆìŠ¤í„° - AI ì „ëµ ì‹œë®¬ë ˆì´í„°">
    <meta property="og:description" content="ìˆ˜í•™ì  í™•ë¥ ì— ê¸°ë°˜í•œ ìµœì ì˜ ë¸”ë™ì­ ì „ëµì„ ë°°ìš°ê³  ì‹¤ìŠµí•˜ì„¸ìš”.">
    <meta property="og:image" content="https://your-domain.com/og-image.jpg">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        :root {
            --gold: #FFD700;
            --success: #4CAF50;
            --danger: #FF5252;
            --bg-dark: #0f172a;
            --card-white: #ffffff;
            --accent-blue: #3b82f6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            background: radial-gradient(circle at center, #1e293b 0%, #0f172a 100%);
            color: #f8fafc;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .game-container {
            width: 95%;
            max-width: 900px;
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(12px);
            padding: 30px;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            text-align: center;
            position: relative;
            box-sizing: border-box;
        }

        /* ì–¸ì–´ ì„ íƒê¸° */
        .lang-selector {
            position: absolute;
            top: 15px;
            right: 20px;
            z-index: 10;
        }

        .lang-selector select {
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 5px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.8em;
            outline: none;
        }

        .header-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            font-size: 1.0em;
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-top: 25px;
        }

        .stat-item span {
            color: var(--gold);
            font-weight: 800;
            margin-left: 5px;
        }

        .hand-section {
            margin: 15px 0;
            padding: 15px;
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
        }

        .hand-section.active {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent-blue);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.15);
            transform: scale(1.02);
        }

        .hand-label {
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #94a3b8;
            margin-bottom: 8px;
        }

        .score-badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-left: 5px;
        }

        .cards-display {
            display: flex;
            justify-content: center;
            gap: 12px;
            min-height: 100px;
            margin-top: 10px;
            perspective: 1000px;
            flex-wrap: wrap;
        }

        .card {
            width: 65px;
            height: 90px;
            background: var(--card-white);
            color: #1e293b;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 1.6em;
            font-weight: 700;
            box-shadow: 0 8px 12px -3px rgba(0, 0, 0, 0.3);
            animation: dealIn 0.5s ease-out backwards;
            user-select: none;
        }

        @keyframes dealIn {
            from { transform: translateY(-30px) rotateY(90deg); opacity: 0; }
            to { transform: translateY(0) rotateY(0); opacity: 1; }
        }

        .card.red { color: var(--danger); }
        .card.back { 
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: transparent;
            border: 2px solid white;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 25px;
        }

        button {
            padding: 15px 10px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        button:active { transform: translateY(2px); }
        button:disabled { 
            opacity: 0.2; 
            cursor: not-allowed; 
            filter: grayscale(1); 
        }

        .btn-primary { background: var(--accent-blue); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-warning { background: var(--gold); color: #1e293b; }
        .btn-deal { 
            grid-column: 1 / -1; 
            background: white; 
            color: var(--bg-dark);
            font-size: 1.1em;
            margin-top: 5px;
            padding: 18px;
        }

        .analysis-panel {
            margin-top: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 18px;
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .analysis-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            color: var(--gold);
            font-weight: 600;
            font-size: 0.95em;
        }

        .feedback-msg {
            font-size: 0.95em;
            line-height: 1.5;
        }

        .strategy-reason {
            display: block;
            margin-top: 8px;
            font-size: 0.85em;
            color: #94a3b8;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 8px;
        }

        #result-banner {
            font-size: 1.3em;
            font-weight: 800;
            color: var(--gold);
            margin: 15px 0;
            min-height: 1.5em;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        /* PC í™”ë©´ ìµœì í™” (600px ì´ìƒ) */
        @media (min-width: 600px) {
            .game-container { padding: 40px; }
            .controls { grid-template-columns: repeat(4, 1fr); }
            .card { width: 75px; height: 110px; font-size: 1.9em; }
            .header-stats { font-size: 1.1em; padding: 15px 30px; }
            #result-banner { font-size: 1.6em; }
            .feedback-msg { font-size: 1.05em; }
            .btn-deal { font-size: 1.2em; padding: 20px; }
        }

        /* ëª¨ë°”ì¼ ì‘ì€ í™”ë©´ ìµœì í™” (350px ì´í•˜) */
        @media (max-width: 350px) {
            .card { width: 55px; height: 80px; font-size: 1.4em; }
            .header-stats { flex-direction: column; gap: 5px; }
        }
    </style>
</head>
<body>

<div class="game-container">
    <div class="lang-selector">
        <select id="language-select">
            <option value="ko">í•œêµ­ì–´ (KR)</option>
            <option value="en">English (EN)</option>
        </select>
    </div>

    <div class="header-stats">
        <div class="stat-item"><span id="txt-capital-label">ìì‚°</span> <span>$<span id="balance">1000</span></span></div>
        <div class="stat-item"><span id="txt-stake-label">íŒëˆ</span> <span>$<span id="bet">50</span></span></div>
    </div>

    <div id="dealer-area" class="hand-section">
        <div class="hand-label"><span id="txt-dealer-label">ë”œëŸ¬</span> <span id="dealer-score-val" class="score-badge">?</span></div>
        <div id="dealer-cards" class="cards-display"></div>
    </div>

    <div id="player-hands-container"></div>

    <div id="result-banner"></div>

    <div class="controls">
        <button id="hit-btn" class="btn-success">Hit</button>
        <button id="hold-btn" class="btn-danger">Hold</button>
        <button id="double-btn" class="btn-warning">Double</button>
        <button id="split-btn" class="btn-primary" style="background: #9333ea;">Split</button>
        <button id="deal-btn" class="btn-deal">ìƒˆ ê²Œì„ ì‹œì‘</button>
    </div>

    <div class="analysis-panel">
        <div class="analysis-header" id="txt-strategy-header">ğŸ’¡ AI ì „ëµ ì–´ì‹œìŠ¤í„´íŠ¸</div>
        <div id="analysis-content" class="feedback-msg">ê²Œì„ì„ ì‹œì‘í•˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìµœì ì˜ ì „ëµ í”¼ë“œë°±ì„ ë“œë¦½ë‹ˆë‹¤.</div>
    </div>
</div>

<script>
    const i18n = {
        ko: {
            capital: "ìì‚°", stake: "íŒëˆ", dealer: "ë”œëŸ¬", hand: "í•¸ë“œ", deal: "ìƒˆ ê²Œì„ ì‹œì‘",
            hit: "íˆíŠ¸ (Hit)", hold: "ìŠ¤í…Œì´ (Hold)", double: "ë”ë¸” ë‹¤ìš´", split: "ìŠ¤í”Œë¦¿",
            strategyHeader: "ğŸ’¡ AI ì „ëµ ì–´ì‹œìŠ¤í„´íŠ¸",
            strategyStart: "ê²Œì„ì„ ì‹œì‘í•˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìµœì ì˜ ì „ëµ í”¼ë“œë°±ì„ ë“œë¦½ë‹ˆë‹¤.",
            perfect: "âœ” ì™„ë²½í•œ ê²°ì •ì…ë‹ˆë‹¤!",
            perfectDesc: "ìµœì ì˜ ìˆ˜ëŠ” <b>{optimal}</b>ì´ì—ˆìŠµë‹ˆë‹¤.",
            error: "âœ˜ ì „ëµì  ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.",
            errorDesc: "ë‹¹ì‹ ì€ <b>{action}</b>ì„(ë¥¼) ì„ íƒí–ˆì§€ë§Œ, ê¸°ë³¸ ì „ëµì€ <b>{optimal}</b>ì„(ë¥¼) ê¶Œì¥í•©ë‹ˆë‹¤.",
            bust: "ë²„ìŠ¤íŠ¸ (Bust)", win: "ìŠ¹ë¦¬", lose: "íŒ¨ë°°", push: "ë¬´ìŠ¹ë¶€", blackjack: "ë¸”ë™ì­",
            reasons: {
                splitAA: "A-A ìŠ¤í”Œë¦¿ì€ ë¸”ë™ì­ ìµœê³ ì˜ ì „ëµì…ë‹ˆë‹¤. ê°ê°ì˜ Aê°€ ê°•ë ¥í•œ í•¸ë“œ(21)ë¥¼ ë§Œë“¤ ê¸°íšŒë¥¼ ì œê³µí•©ë‹ˆë‹¤.",
                split88: "8-8ì€ í•©ê³„ê°€ 16ìœ¼ë¡œ ê°€ì¥ ë¶ˆë¦¬í•œ í•¸ë“œì…ë‹ˆë‹¤. ìŠ¤í”Œë¦¿í•˜ì—¬ ë” ë‚˜ì€ í•¸ë“œë¥¼ ë…¸ë¦¬ëŠ” ê²ƒì´ ìˆ˜í•™ì ìœ¼ë¡œ ìœ ë¦¬í•©ë‹ˆë‹¤.",
                split10: "10-10ì€ ì´ë¯¸ 20ì ìœ¼ë¡œ ë§¤ìš° ê°•ë ¥í•œ í•¸ë“œì…ë‹ˆë‹¤. ì´ë¥¼ ì°¢ëŠ” ê²ƒì€ ìŠ¹ë¥ ì„ ë‚®ì¶”ëŠ” í–‰ìœ„ì…ë‹ˆë‹¤.",
                splitPairWeak: "ë”œëŸ¬ì˜ ì˜¤í”ˆ ì¹´ë“œê°€ ì•½í•˜ë¯€ë¡œ(2-6), ìŠ¤í”Œë¦¿ì„ í†µí•´ íŒëˆì„ ëŠ˜ë¦¬ê³  ë”œëŸ¬ì˜ ë²„ìŠ¤íŠ¸ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.",
                standHigh: "17ì  ì´ìƒì€ ì¶”ê°€ ì¹´ë“œë¥¼ ë°›ì„ ë•Œ ë²„ìŠ¤íŠ¸ë  í™•ë¥ ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ë”œëŸ¬ì˜ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.",
                standDealerWeak: "í”Œë ˆì´ì–´ì˜ ì ìˆ˜ê°€ ë‚®ë”ë¼ë„ ë”œëŸ¬ì˜ ì˜¤í”ˆ ì¹´ë“œê°€ 2-6ì´ë©´ ë”œëŸ¬ê°€ ë²„ìŠ¤íŠ¸ë  í™•ë¥ ì´ ë†’ìœ¼ë¯€ë¡œ ë©ˆì¶”ëŠ” ê²ƒì´ ìœ ë¦¬í•©ë‹ˆë‹¤.",
                hitToImprove: "ë”œëŸ¬ì˜ ì˜¤í”ˆ ì¹´ë“œê°€ ê°•í•˜ë¯€ë¡œ(7-A), í˜„ì¬ ì ìˆ˜ë¡œëŠ” ì´ê¸°ê¸° ì–´ë µìŠµë‹ˆë‹¤. ìœ„í—˜ì„ ê°ìˆ˜í•˜ê³  ì ìˆ˜ë¥¼ ë†’ì—¬ì•¼ í•©ë‹ˆë‹¤.",
                double11: "í•©ê³„ 11ì€ ë‹¤ìŒ ì¹´ë“œì—ì„œ 10ì  ì¹´ë“œë¥¼ ë°›ì•„ 21ì„ ë§Œë“¤ í™•ë¥ ì´ ì•½ 30%ë¡œ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤.",
                doubleStrong: "ë‚´ íŒ¨ì˜ ê°œì„  í™•ë¥ ì´ ë†’ê³  ë”œëŸ¬ëŠ” ë²„ìŠ¤íŠ¸ë  ìœ„í—˜ì´ í° ìƒí™©ì´ë¯€ë¡œ íŒëˆì„ ë‘ ë°°ë¡œ ëŠ˜ë ¤ ìˆ˜ìµì„ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.",
                softImprove: "Aë¥¼ í¬í•¨í•œ ì†Œí”„íŠ¸ í•¸ë“œëŠ” ë²„ìŠ¤íŠ¸ ìœ„í—˜ ì—†ì´ íŒ¨ë¥¼ ê°œì„ í•  ìˆ˜ ìˆëŠ” ë¬´ë£Œ ê¸°íšŒì…ë‹ˆë‹¤."
            }
        },
        en: {
            capital: "CAPITAL", stake: "STAKE", dealer: "DEALER", hand: "HAND", deal: "DEAL NEW HAND",
            hit: "HIT", hold: "HOLD", double: "DOUBLE", split: "SPLIT",
            strategyHeader: "ğŸ’¡ AI STRATEGY ASSISTANT",
            strategyStart: "Start a new game to receive real-time strategy feedback.",
            perfect: "âœ” PERFECT DECISION!",
            perfectDesc: "The optimal move was <b>{optimal}</b>.",
            error: "âœ˜ STRATEGIC ERROR",
            errorDesc: "You chose <b>{action}</b>, but basic strategy suggests <b>{optimal}</b>.",
            bust: "BUST", win: "WIN", lose: "LOSE", push: "PUSH", blackjack: "BLACKJACK",
            reasons: {
                splitAA: "Splitting Aces is the best move as it gives you two chances to hit 21 with a single card.",
                split88: "A hard 16 is the worst total. Splitting 8s breaks it into two hands with better potential.",
                split10: "A total of 20 is a very strong hand. Splitting 10s significantly lowers your win probability.",
                splitPairWeak: "The dealer shows a weak upcard (2-6). Splitting allows you to maximize profit on their high bust risk.",
                standHigh: "With 17+, the risk of busting is extremely high. It's safer to stand and wait for the dealer.",
                standDealerWeak: "The dealer has a high bust probability with 2-6. You don't need a high score to win.",
                hitToImprove: "Against a strong dealer upcard (7-A), you need to take a risk to improve your score.",
                double11: "A total of 11 has a high probability (~30%) of hitting 21 with the next card.",
                doubleStrong: "You have a strong chance to improve while the dealer is vulnerable. Double down to maximize value.",
                softImprove: "Soft hands allow you to hit without the risk of busting, giving you a free shot to improve."
            }
        }
    };

    const gameState = {
        lang: 'ko', phase: 'IDLE', balance: 1000, bet: 50, currentHandIndex: 0,
        deck: [], playerHands: [], dealerHand: []
    };

    const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
    const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

    function initDeck() {
        gameState.deck = [];
        for (let i = 0; i < 6; i++) {
            for (let s of suits) for (let r of ranks) gameState.deck.push({ rank: r, suit: s });
        }
        gameState.deck.sort(() => Math.random() - 0.5);
    }

    function draw() {
        if (gameState.deck.length < 20) initDeck();
        return gameState.deck.pop();
    }

    function getCardValue(card) {
        if (card.rank === 'A') return 11;
        if (['K', 'Q', 'J', '10'].includes(card.rank)) return 10;
        return parseInt(card.rank);
    }

    function calculateScore(hand) {
        let score = hand.reduce((acc, c) => acc + getCardValue(c), 0);
        let aces = hand.filter(c => c.rank === 'A').length;
        while (score > 21 && aces > 0) { score -= 10; aces--; }
        return score;
    }

    function getOptimalActionData() {
        const hand = gameState.playerHands[gameState.currentHandIndex].cards;
        const dCard = gameState.dealerHand[0];
        const pScore = calculateScore(hand);
        const dVal = getCardValue(dCard);
        const canSplit = hand.length === 2 && getCardValue(hand[0]) === getCardValue(hand[1]);
        const canDouble = hand.length === 2;

        if (canSplit) {
            const v = getCardValue(hand[0]);
            if (v === 11) return { action: 'Split', reason: 'splitAA' };
            if (v === 8) return { action: 'Split', reason: 'split88' };
            if (v === 10) return { action: 'Hold', reason: 'split10' };
            if ([2, 3, 7].includes(v) && dVal <= 7) return { action: 'Split', reason: 'splitPairWeak' };
            if (v === 6 && dVal <= 6) return { action: 'Split', reason: 'splitPairWeak' };
            if (v === 4 && [5, 6].includes(dVal)) return { action: 'Split', reason: 'splitPairWeak' };
            if (v === 9 && ![7, 10, 11].includes(dVal)) return { action: 'Split', reason: 'splitPairWeak' };
        }

        const isSoft = hand.length === 2 && hand.some(c => c.rank === 'A');
        if (isSoft) {
            if (pScore >= 19) return { action: 'Hold', reason: 'standHigh' };
            if (pScore === 18 && dVal <= 8) return { action: 'Hold', reason: 'standHigh' };
            if (pScore === 18 && dVal >= 9) return { action: 'Hit', reason: 'hitToImprove' };
            return { action: 'Hit', reason: 'softImprove' };
        }

        if (pScore >= 17) return { action: 'Hold', reason: 'standHigh' };
        if (pScore >= 13 && dVal <= 6) return { action: 'Hold', reason: 'standDealerWeak' };
        if (pScore === 12 && [4, 5, 6].includes(dVal)) return { action: 'Hold', reason: 'standDealerWeak' };
        if (pScore === 11) return { action: canDouble ? 'Double' : 'Hit', reason: 'double11' };
        if (pScore === 10 && dVal <= 9) return { action: canDouble ? 'Double' : 'Hit', reason: 'doubleStrong' };
        if (pScore === 9 && [3, 4, 5, 6].includes(dVal)) return { action: canDouble ? 'Double' : 'Hit', reason: 'doubleStrong' };

        return { action: 'Hit', reason: 'hitToImprove' };
    }

    function updateUI() {
        const t = i18n[gameState.lang];
        document.getElementById('txt-capital-label').textContent = t.capital;
        document.getElementById('txt-stake-label').textContent = t.stake;
        document.getElementById('txt-dealer-label').textContent = t.dealer;
        document.getElementById('txt-strategy-header').textContent = t.strategyHeader;
        document.getElementById('deal-btn').textContent = t.deal;
        document.getElementById('hit-btn').textContent = t.hit;
        document.getElementById('hold-btn').textContent = t.hold;
        document.getElementById('double-btn').textContent = t.double;
        document.getElementById('split-btn').textContent = t.split;
        
        if (gameState.phase === 'IDLE') document.getElementById('analysis-content').textContent = t.strategyStart;

        document.getElementById('balance').textContent = gameState.balance;
        document.getElementById('bet').textContent = gameState.bet;

        const dCardsCont = document.getElementById('dealer-cards');
        dCardsCont.innerHTML = '';
        const revealDealer = gameState.phase === 'DEALER_TURN' || gameState.phase === 'END';
        gameState.dealerHand.forEach((c, i) => {
            const cardEl = document.createElement('div');
            const isHidden = (i === 1 && !revealDealer);
            cardEl.className = `card ${isHidden ? 'back' : ''} ${!isHidden && (c.suit === 'â™¥' || c.suit === 'â™¦') ? 'red' : ''}`;
            cardEl.innerHTML = isHidden ? '' : `<span>${c.rank}</span><small>${c.suit}</small>`;
            dCardsCont.appendChild(cardEl);
        });
        document.getElementById('dealer-score-val').textContent = revealDealer ? calculateScore(gameState.dealerHand) : '?';

        const pCont = document.getElementById('player-hands-container');
        pCont.innerHTML = '';
        gameState.playerHands.forEach((hand, idx) => {
            const section = document.createElement('div');
            section.className = `hand-section ${idx === gameState.currentHandIndex && gameState.phase === 'PLAYER_TURN' ? 'active' : ''}`;
            section.innerHTML = `<div class="hand-label">${t.hand} ${idx + 1} <span class="score-badge">${calculateScore(hand.cards)}</span> â€” $${hand.bet}</div>`;
            const cardsDiv = document.createElement('div');
            cardsDiv.className = 'cards-display';
            hand.cards.forEach(c => {
                const cel = document.createElement('div');
                cel.className = `card ${c.suit === 'â™¥' || c.suit === 'â™¦' ? 'red' : ''}`;
                cel.innerHTML = `<span>${c.rank}</span><small>${c.suit}</small>`;
                cardsDiv.appendChild(cel);
            });
            section.appendChild(cardsDiv);
            pCont.appendChild(section);
        });

        const isTurn = gameState.phase === 'PLAYER_TURN';
        document.getElementById('hit-btn').disabled = !isTurn;
        document.getElementById('hold-btn').disabled = !isTurn;
        if (isTurn) {
            const curHand = gameState.playerHands[gameState.currentHandIndex];
            const canAct = curHand.cards.length === 2;
            document.getElementById('double-btn').disabled = !canAct || gameState.balance < curHand.bet;
            document.getElementById('split-btn').disabled = !canAct || getCardValue(curHand.cards[0]) !== getCardValue(curHand.cards[1]);
        } else {
            document.getElementById('double-btn').disabled = true;
            document.getElementById('split-btn').disabled = true;
        }
        document.getElementById('deal-btn').disabled = (gameState.phase === 'PLAYER_TURN' || gameState.phase === 'DEALER_TURN');
    }

    function provideFeedback(playerAction) {
        const { action: optimal, reason } = getOptimalActionData();
        const t = i18n[gameState.lang];
        const content = document.getElementById('analysis-content');
        const actionMap = { 'Hit': t.hit, 'Hold': t.hold, 'Double': t.double, 'Split': t.split };
        const optLocal = actionMap[optimal];
        const actLocal = actionMap[playerAction];

        let feedbackHTML = "";
        if (playerAction === optimal) {
            feedbackHTML = `<span style="color:var(--success)">${t.perfect}</span> ${t.perfectDesc.replace('{optimal}', optLocal)}`;
        } else {
            feedbackHTML = `<span style="color:var(--danger)">${t.error}</span> ${t.errorDesc.replace('{action}', actLocal).replace('{optimal}', optLocal)}`;
        }
        feedbackHTML += `<span class="strategy-reason">${t.reasons[reason]}</span>`;
        content.innerHTML = feedbackHTML;

        if (typeof gtag === 'function') {
            gtag('event', 'player_action', { 'action_type': playerAction, 'is_optimal': playerAction === optimal, 'score': calculateScore(gameState.playerHands[gameState.currentHandIndex].cards) });
        }
    }

    function handleDeal() {
        if (gameState.balance < gameState.bet) return;
        if (gameState.deck.length === 0) initDeck();
        gameState.balance -= gameState.bet;
        gameState.phase = 'PLAYER_TURN';
        gameState.currentHandIndex = 0;
        gameState.dealerHand = [draw(), draw()];
        gameState.playerHands = [{ cards: [draw(), draw()], bet: gameState.bet, isDone: false }];
        document.getElementById('result-banner').textContent = '';
        document.getElementById('analysis-content').textContent = gameState.lang === 'ko' ? "íŒ¨ë¥¼ ë¶„ì„ ì¤‘..." : "Analyzing hand...";
        updateUI();
        if (calculateScore(gameState.playerHands[0].cards) === 21) nextHand();
    }

    function handleHit() { provideFeedback('Hit'); const h = gameState.playerHands[gameState.currentHandIndex]; h.cards.push(draw()); if (calculateScore(h.cards) >= 21) nextHand(); updateUI(); }
    function handleHold() { provideFeedback('Hold'); nextHand(); updateUI(); }
    function handleDouble() { provideFeedback('Double'); const h = gameState.playerHands[gameState.currentHandIndex]; gameState.balance -= h.bet; h.bet *= 2; h.cards.push(draw()); nextHand(); updateUI(); }
    function handleSplit() { provideFeedback('Split'); const hands = gameState.playerHands; const cur = hands[gameState.currentHandIndex]; gameState.balance -= cur.bet; const newHand = { cards: [cur.cards.pop(), draw()], bet: cur.bet, isDone: false }; cur.cards.push(draw()); hands.splice(gameState.currentHandIndex + 1, 0, newHand); updateUI(); }
    function nextHand() { gameState.currentHandIndex++; if (gameState.currentHandIndex >= gameState.playerHands.length) { gameState.phase = 'DEALER_TURN'; dealerTurn(); } }
    async function dealerTurn() { updateUI(); await new Promise(r => setTimeout(r, 800)); while (calculateScore(gameState.dealerHand) < 17) { gameState.dealerHand.push(draw()); updateUI(); await new Promise(r => setTimeout(r, 800)); } gameState.phase = 'END'; finalize(); }

    function finalize() {
        const dScore = calculateScore(gameState.dealerHand);
        const t = i18n[gameState.lang];
        let results = [];
        gameState.playerHands.forEach((h, i) => {
            const pScore = calculateScore(h.cards);
            let resTxt = "";
            if (pScore > 21) resTxt = t.bust;
            else if (dScore > 21 || pScore > dScore) {
                const isBJ = pScore === 21 && h.cards.length === 2;
                gameState.balance += isBJ ? h.bet * 2.5 : h.bet * 2;
                resTxt = `${t.win} ${isBJ ? '('+t.blackjack+')' : ''}`;
            } else if (pScore === dScore) { gameState.balance += h.bet; resTxt = t.push; }
            else resTxt = t.lose;
            results.push(`H${i+1}: ${resTxt}`);
        });
        document.getElementById('result-banner').textContent = results.join(' | ');
        updateUI();
        if (typeof gtag === 'function') { gtag('event', 'game_end', { 'final_balance': gameState.balance, 'dealer_score': dScore }); }
    }

    document.getElementById('deal-btn').onclick = handleDeal;
    document.getElementById('hit-btn').onclick = handleHit;
    document.getElementById('hold-btn').onclick = handleHold;
    document.getElementById('double-btn').onclick = handleDouble;
    document.getElementById('split-btn').onclick = handleSplit;
    document.getElementById('language-select').onchange = (e) => { gameState.lang = e.target.value; updateUI(); };
    initDeck();
    updateUI();
</script>
      <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('../../footer.html')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('footer-placeholder').innerHTML = data;
                    lucide.createIcons();
                })
                .catch(error => {
                    console.error('Error fetching footer:', error);
                    document.getElementById('footer-placeholder').innerHTML = '<p style="text-align: center; color: red;">í‘¸í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
                });
        });
    </script>
</body>
  <!-- Last updated: 2026-02-06 15:16 KST -->
</html>
